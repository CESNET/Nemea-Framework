<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UniRec: Helpers for libtrap</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UniRec
   &#160;<span id="projectnumber">2.2.6</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">Helpers for libtrap</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gae7a20329dfe3f847174cf076d5054cac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__libtraphelpers.html#gae7a20329dfe3f847174cf076d5054cac">TRAP_RECEIVE</a>(ifc_num,  data,  data_size,  tmplt)&#160;&#160;&#160;<a class="el" href="group__libtraphelpers.html#gac3f8ae5f2495115a5b4c04d02646c7b3">TRAP_CTX_RECEIVE</a>(trap_get_global_ctx(), ifc_num, data, data_size, tmplt);</td></tr>
<tr class="memdesc:gae7a20329dfe3f847174cf076d5054cac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data from interface Receive data with specified template from libtrap interface. If the receiving template is subset of sending template, it will define new fields and expand receiving template.  <a href="#gae7a20329dfe3f847174cf076d5054cac">More...</a><br /></td></tr>
<tr class="separator:gae7a20329dfe3f847174cf076d5054cac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac3f8ae5f2495115a5b4c04d02646c7b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__libtraphelpers.html#gac3f8ae5f2495115a5b4c04d02646c7b3">TRAP_CTX_RECEIVE</a>(ctx,  ifc_num,  data,  data_size,  tmplt)</td></tr>
<tr class="memdesc:gac3f8ae5f2495115a5b4c04d02646c7b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data from interface with given context Receive data with specified template from libtrap interface with specified context. If the receiving template is subset of sending template, it will define new fields and expand receiving template.  <a href="#gac3f8ae5f2495115a5b4c04d02646c7b3">More...</a><br /></td></tr>
<tr class="separator:gac3f8ae5f2495115a5b4c04d02646c7b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This module defines useful macros for handling data receive. When data format is changed, these macros create new UniRec template. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gac3f8ae5f2495115a5b4c04d02646c7b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac3f8ae5f2495115a5b4c04d02646c7b3">&#9670;&nbsp;</a></span>TRAP_CTX_RECEIVE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TRAP_CTX_RECEIVE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ctx, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ifc_num, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data_size, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tmplt&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({\</div><div class="line">   int ret = trap_ctx_recv(ctx, ifc_num, &amp;data, &amp;data_size);\</div><div class="line">   if (ret == TRAP_E_FORMAT_CHANGED) {\</div><div class="line">      const <span class="keywordtype">char</span> *spec = NULL;\</div><div class="line">      uint8_t data_fmt;\</div><div class="line">      if (trap_ctx_get_data_fmt(ctx, TRAPIFC_INPUT, ifc_num, &amp;data_fmt, &amp;spec) != TRAP_E_OK) {\</div><div class="line">         fprintf(stderr, <span class="stringliteral">&quot;Data format was not loaded.\n&quot;</span>);\</div><div class="line">      } <span class="keywordflow">else</span> {\</div><div class="line">         tmplt = <a class="code" href="group__urtemplate.html#ga4b090390e3e2728d2d59168eb532633a">ur_define_fields_and_update_template</a>(spec, tmplt);\</div><div class="line">         if (tmplt == NULL) {\</div><div class="line">            fprintf(stderr, <span class="stringliteral">&quot;Template could not be edited.\n&quot;</span>);\</div><div class="line">         } <span class="keywordflow">else</span> {\</div><div class="line">            if (tmplt-&gt;direction == <a class="code" href="unirec_8h.html#a85bbc4f5be324da3382d0b587e9ae4aead92326143d975004bacb08640930fead">UR_TMPLT_DIRECTION_BI</a>) {\</div><div class="line">               char * spec_cpy = <a class="code" href="group__urtemplate.html#ga11693505eb5de52b6b2b021aeaf1a7e1">ur_cpy_string</a>(spec);\</div><div class="line">               if (spec_cpy == NULL) {\</div><div class="line">                  fprintf(stderr, <span class="stringliteral">&quot;Memory allocation problem.\n&quot;</span>);\</div><div class="line">               } <span class="keywordflow">else</span> {\</div><div class="line">                  trap_ctx_set_data_fmt(ctx, tmplt-&gt;ifc_out, TRAP_FMT_UNIREC, spec_cpy);\</div><div class="line">               }\</div><div class="line">            }\</div><div class="line">         }\</div><div class="line">      }\</div><div class="line">   }\</div><div class="line">   ret;\</div><div class="line">})</div><div class="ttc" id="group__urtemplate_html_ga11693505eb5de52b6b2b021aeaf1a7e1"><div class="ttname"><a href="group__urtemplate.html#ga11693505eb5de52b6b2b021aeaf1a7e1">ur_cpy_string</a></div><div class="ttdeci">char * ur_cpy_string(const char *str)</div><div class="ttdoc">Duplicates given string. Helper function which returns pointer to duplicated string. New string has to be freed by user. </div><div class="ttdef"><b>Definition:</b> <a href="unirec_8c_source.html#l01338">unirec.c:1338</a></div></div>
<div class="ttc" id="unirec_8h_html_a85bbc4f5be324da3382d0b587e9ae4aead92326143d975004bacb08640930fead"><div class="ttname"><a href="unirec_8h.html#a85bbc4f5be324da3382d0b587e9ae4aead92326143d975004bacb08640930fead">UR_TMPLT_DIRECTION_BI</a></div><div class="ttdoc">bidirection </div><div class="ttdef"><b>Definition:</b> <a href="unirec_8h_source.html#l00114">unirec.h:114</a></div></div>
<div class="ttc" id="group__urtemplate_html_ga4b090390e3e2728d2d59168eb532633a"><div class="ttname"><a href="group__urtemplate.html#ga4b090390e3e2728d2d59168eb532633a">ur_define_fields_and_update_template</a></div><div class="ttdeci">ur_template_t * ur_define_fields_and_update_template(const char *ifc_data_fmt, ur_template_t *tmplt)</div><div class="ttdoc">Defined new fields and expand an UniRec template Define new fields (function ur_define_set_of_fields)...</div><div class="ttdef"><b>Definition:</b> <a href="unirec_8c_source.html#l00537">unirec.c:537</a></div></div>
</div><!-- fragment -->
<p>Receive data from interface with given context Receive data with specified template from libtrap interface with specified context. If the receiving template is subset of sending template, it will define new fields and expand receiving template. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ifc_num</td><td>index of libtrap interface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>pointer to memory where the data will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_size</td><td>size of allocated space for data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmplt</td><td>pointer to input template </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return value of trap_ctx_recv </dd></dl>

<p class="definition">Definition at line <a class="el" href="unirec_8h_source.html#l00214">214</a> of file <a class="el" href="unirec_8h_source.html">unirec.h</a>.</p>

</div>
</div>
<a id="gae7a20329dfe3f847174cf076d5054cac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae7a20329dfe3f847174cf076d5054cac">&#9670;&nbsp;</a></span>TRAP_RECEIVE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TRAP_RECEIVE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ifc_num, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data_size, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tmplt&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="group__libtraphelpers.html#gac3f8ae5f2495115a5b4c04d02646c7b3">TRAP_CTX_RECEIVE</a>(trap_get_global_ctx(), ifc_num, data, data_size, tmplt);</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive data from interface Receive data with specified template from libtrap interface. If the receiving template is subset of sending template, it will define new fields and expand receiving template. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ifc_num</td><td>index of libtrap interface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>pointer to memory where the data will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_size</td><td>size of allocated space for data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmplt</td><td>pointer to input template </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return value of trap_recv </dd></dl>

<p class="definition">Definition at line <a class="el" href="unirec_8h_source.html#l00200">200</a> of file <a class="el" href="unirec_8h_source.html">unirec.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
