<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Libtrap: Internal development docs: Development of libtrap interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Libtrap: Internal development docs
   &#160;<span id="projectnumber">0.10.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Development of libtrap interface </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro"></a>
General information</h1>
<p>There are two types of libtrap interfaces (unidirectional) &mdash; <em>input</em> and <em>output</em>. After successful initialization of libtrap (<a class="el" href="group__contextapi.html#gad63272a184d3a4f5a386bf10629f4266" title="Initialize and return the context of libtrap. ">trap_ctx_init()</a>), all interfaces are stored in libtrap context in the array <a class="el" href="structtrap__ctx__priv__s.html#a0c1dbb818a0ca11597f28c494a30cd5f">trap_ctx_priv_s::in_ifc_list</a> or <a class="el" href="structtrap__ctx__priv__s.html#a7dc607a5c8f21a2ecc8501c3356ed14a">trap_ctx_priv_s::out_ifc_list</a>. That means every IFC must initialize its structure <a class="el" href="structtrap__input__ifc__s.html">trap_input_ifc_s</a> or <a class="el" href="structtrap__output__ifc__s.html">trap_output_ifc_s</a> as it is listed in Steps section below.</p>
<p>Libtrap interface (IFC) is a source code file that is compiled with the rest of libtrap. Every IFC implements functions:</p>
<pre>
typedef void (*ifc_terminate_func_t)(void *);
typedef void (*ifc_destroy_func_t)(void *);
typedef void (*ifc_create_dump_func_t)(void *, uint32_t, const char *);
</pre><p>and one or both functions:</p>
<pre>
typedef int (*ifc_recv_func_t)(void *, void *, uint32_t *, int);
typedef int (*ifc_send_func_t)(void *, const void *, uint32_t, int);
</pre><p> The full list of required functions of IFC can be found in <a class="el" href="group__trap__ifc__api.html">IFC API</a>.</p>
<p>Additionally, IFC should implement it's own constructor function.</p>
<h1><a class="anchor" id="steps"></a>
What to do to develop IFC</h1>
<p>To add new IFC into libtrap some steps should be done:</p>
<ol>
<li>
choose new IFC type letter by defining new macro in <a class="el" href="group__ifctypes.html">Types of IFC</a>. </li>
<li>
add new IFC type into <a class="el" href="group__ifctypes.html#ga6419b14997f2d75db88aae23213be54e">trap_ifc_type_supported</a> </li>
<li>
add call to constructor into <a class="el" href="group__contextapi.html#ga8e3bd04c657631263c17fa9aa05d39e7">trapifc_in_construct()</a> resp. <a class="el" href="group__contextapi.html#ga30009499f64ee53baecf6b01263d9875">trapifc_out_construct()</a> for input resp. output IFC </li>
<li>
write own implementation of IFC functions (<a class="el" href="group__trap__ifc__api.html">IFC API</a>) </li>
<li>
write own constructor of new IFC </li>
<li>
set pointers to functions in <a class="el" href="structtrap__input__ifc__s.html">trap_input_ifc_s</a> or <a class="el" href="structtrap__output__ifc__s.html">trap_output_ifc_s</a>, the setting of pointers should be done in IFC's constructor </li>
</ol>
<p>Simplified example of input IFC can be found in <a class="el" href="ifc__dummy_8c.html" title="TRAP dummy interfaces (generator and blackhole) ">ifc_dummy.c</a>. This file implements blackhole and generator. Blackhole is the output IFC that drops every message that is sent by module. Generator is the input IFC generates messages that are received by module.</p>
<p>More complex example is TCPIP and UNIX socket IFCs implemented in <a class="el" href="ifc__tcpip_8c.html" title="TRAP TCP/IP interfaces. ">ifc_tcpip.c</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
